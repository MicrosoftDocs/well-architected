---
title: Azure Well-Architected Framework perspective on Azure NetApp Files
description: See Azure Well-Architected Framework design considerations and configuration recommendations that are relevant to Azure NetApp Files.
author: gvanteylingen
ms.author: b-ahibbard
ms.date: 09/20/2024
ms.topic: conceptual
ms.service: azure-netapp-files
ms.subservice: waf-service-guide
products:
  - azure-netapp-files
categories:
  - storage
---

# Azure Well-Architected Framework perspective on Azure NetApp Files

Azure NetApp Files is an Azure-native, enterprise-class service that you can use to run file workloads in the cloud and store files. Azure NetApp Files is a fully managed, cloud-based service that you can use to create NetApp accounts, capacity pools, and volumes, choose service and performance levels, and manage data protection.

Create and manage file shares that have the following capabilities: 
- High performance
- Low latency
- High availability
- Scalability

Use familiar protocols and tools that you use for on-premises enterprise applications. Azure NetApp Files supports Server Block Message (SMB), Network File System (NFS), and dual-protocol volumes. You can use Azure NetApp Files for file sharing, high-performance computing, home directories, and databases.

This article assumes that as an architect, you reviewed the [file storage options](/azure/architecture/guide/storage/storage-start-here) and chose Azure NetApp Files as the service for your workloads. The guidance in this article provides architectural recommendations that are mapped to the principles of the [Well-Architected Framework pillars](../pillars.md).

> [!IMPORTANT]
>
> **How to use this guide**
>
> Each section has a _design checklist_ that presents architectural areas of concern along with design strategies localized to the technology scope.
>
> Also included are _recommendations_ for the technology capabilities that can help materialize those strategies. The recommendations don't represent an exhaustive list of all configurations that are available for Azure NetApp Files and its dependencies. Instead, they list the key recommendations mapped to the design perspectives. Use the recommendations to build your proof-of-concept or to optimize your existing environments.
>
> Foundational architecture that demonstrates the key recommendations: [Moodle deployment with Azure NetApp Files](/azure/architecture/example-scenario/file-storage/moodle-azure-netapp-files).

**Technology scope**

This review focuses on the interrelated decisions for the following Azure resource:
- Azure NetApp Files

## Reliability

The purpose of the Reliability pillar is to provide continued functionality by **building enough resilience and the ability to recover fast from failures**.

[Reliability design principles](/azure/well-architected/resiliency/principles) provide a high-level design strategy applied for individual components, system flows, and the system as a whole.

### Design checklist

Start your design strategy based on the [design review checklist for Reliability](../reliability/checklist.md).

> [!div class="checklist"]
> - **Design your workload to align with business objectives and avoid unnecessary complexity or overhead.** Use a practiced and balanced approach to make decision decisions that reflect the needs of your workload. Decisions for your Azure NetApp Files deployment can introduce consequences for other decisions. For example, you must choose your subnet for your Azure NetApp Files deployment because the subnet size determines the number of available IP addresses. You must also choose the appropriate network features setting because this decision affects available networks and features.
>
> - **Identify user and system flows.** Understand customer needs and business requirements so that you can effectively plan for reliability and optimize security. To limit access to and from necessary networks, use the principle of least privilege when you assign permissions. To authorize access to Azure NetApp Files data, use features or services such as network security groups (NSGs), Microsoft Entra ID with hybrid identities, and Microsoft Entra Domain Services, Active Directory Domain Services (AD DS), and Lightweight Directory Access Protocol (LDAP). To restrict default access to Azure NetApp Files volumes, use features such as file locking.
> - **Define reliability and recovery targets.** Visualize recovery targets and drive actions to achieve reliability and recoverability goals for your workload. To improve reliability and recovery, define these targets and develop an understanding of Azure NetApp Files solutions. Targets help improve snapshots, optimize resiliency with high availability between availability zones, improve cross-zone and cross-region replication, and improve SMB continuous availability for supported applications.
> - **Build redundancy.** Deploy your workload across availability zones and regions to build redundancy in the workload and supporting infrastructure. This approach ensures that you can quickly recover from failures. Active-passive deployments can handle production loads only in the primary region but fail over to the secondary passive region when necessary.

### Recommendations

| Recommendation | Benefit |
| - | - |
| Use [future-proof sizing](/azure/azure-netapp-files/azure-netapp-files-delegate-subnet#considerations) to appropriately determine your delegated subnet size. | Appropriately size your subnet to ensure the long-term resiliency of your design and the scalability of your applications and workloads. |
| [Enable standard networking features](/azure/azure-netapp-files/azure-netapp-files-network-topologies) on your delegated subnet for enhanced resiliency and extra connectivity patterns. | Select standard network features so you can have higher IP limits and standard virtual network features, including extra connectivity patterns and NSGs and user-defined routes on delegated subnets. |
| Use built-in Azure NetApp Files features to build redundancy and ensure the reliability of recovery targets.<br><br> Use [snapshots](/azure/azure-netapp-files/data-protection-disaster-recovery-options#snapshots) to protect business-critical data and enhance recoverability.<br><br> Use the[Azure NetApp Files availability zone volume placement feature](/azure/azure-netapp-files/use-availability-zones) to deploy volumes in availability zones of your choice, in alignment with Azure compute and other services in the same zone.<br><br> Use [cross-zone or cross-region replication](/azure/azure-netapp-files/data-protection-disaster-recovery-options) to design for local or remote disaster recovery. To protect your data from unforeseeable zonal or regional failures, use snapshot technology so you can replicate your Azure NetApp Files instances across designated Azure availability zones or regions. | Snapshots add stability, scalability, and swift recoverability without affecting performance. They provide the foundation for other redundancy solutions, including backup, cross-region replication, and cross-zone replication.<br><br> Azure availability zones are highly available, fault tolerant, and more scalable than traditional single or multiple datacenter infrastructures. To design resilient solutions, use Azure services that support availability zones. Cross-zone and cross-region replication minimizes data transfer, which reduces cost. It also replicates only changed blocks across regions, which creates a lower restore point objective. |
| Ensure application resilience for service maintenance events, for example platform, service, or software upgrades. For more information, see [Address application disruptions](/azure/azure-netapp-files/faq-application-resilience#what-do-you-recommend-for-handling-potential-application-disruptions-due-to-storage-service-maintenance-events). | Some applications might require tuning to handle input/output pauses for up to 30-45 seconds. To maintain application performance and continuity, make sure you understand the application's resiliency settings so you can handle storage service maintenance events. |
| For SMB or dual-protocol workloads, enable [continuous availability for SMB](/azure/azure-netapp-files/azure-netapp-files-create-volumes-smb#continuous-availability) to ensure availability during maintenance events. | If you create an SMB or dual-protocol volume, use continuous availability so that SMB transparent failover for maintenance doesn't interrupt the server applications that store their data on the volume. Some workloads don't support this feature. |
| Make use of the right performance tier, volume sizes, and quality of service (QoS) settings to ensure appropriate performance. The combination of the quota that's assigned to the volume and the selected service level determines the throughput limit for a volume that has automatic QoS. For volumes that have manual QoS, you can define the throughput limit individually. Understand your needs and the offerings in Azure NetApp Files. For more information, see [Performance considerations for Azure NetApp Files](/azure/azure-netapp-files/azure-netapp-files-performance-considerations). | Choose the correct performance tier to avoid unnecessary complexity and overhead and to help manage the total cost of ownership (TCO). |
| Configure 'application filtering' properly for your firewalls. To ensure that you use the correct configuration, see the following resources: <br><br> - [Understand network-attached storage (NAS) protocols in Azure NetApp Files](/azure/azure-netapp-files/network-attached-storage-protocols) <br> - [Guidelines for Azure NetApp Files network planning](/azure/azure-netapp-files/azure-netapp-files-network-topologies) <br> - [Understand guidelines for AD DS site design and planning for Azure NetApp Files](/azure/azure-netapp-files/understand-guidelines-active-directory-domain-service-site) | Configure application filtering correctly to prevent problems such as dropped connections when you attempt to search directories or create items. Windows Server Active Directory, LDAP, and SMB filtering commonly have these problems. Use application filtering to ensures seamless connectivity and efficient network operations. |

## Security

The purpose of the Security pillar is to provide **confidentiality, integrity, and availability** guarantees to the workload.

The [Security design principles](/azure/well-architected/security/security-principles) provide a high-level design strategy for achieving those goals by applying approaches to the technical design of your file storage configuration.

### Design checklist

Start your design strategy based on the [design review checklist for Security](../security/checklist.md). Identify vulnerabilities and controls to improve the security posture. Extend the strategy to include more approaches as needed.

>[!div class="checklist"]
> - **Isolate, filter, and control network traffic across both ingress and egress flows.** Control network traffic to mitigate potential security events. You can filter traffic between Azure resources with an NSG. Or use user-defined routes on the Azure NetApp Files delegated subnet to limit traffic.
>
> - **Implement strict, conditional, and auditable identity and access management.** Strict access to resources provides a frontline of defense. To protect your data resources, use custom role-based access control (RBAC) roles, protocol-based locking tools, and built-in storage policies.
> - **Establish a security baseline that aligns with compliance requirements, industry standards, and platform recommendations.** Storage policies and key management can help you establish a baseline of security with industry standard tools. Azure NetApp Files also supports many of the built-in security recommendations for NFS, SMB, and dual-protocol volumes.
> - **Use modern, industry-standard methods to encrypt data.** The security of your data is essential. Azure NetApp Files provides solutions and features to ensure data security, including double encryption at rest. For Windows Server Active Directory users, Azure NetApp Files supports Advanced Encryption Standard (AES) encryption.
> - **Establish a security baseline.** Azure NetApp Files supports NFS, SMB, and dual-protocol volumes. If you use dual-protocol volumes, understand the security needs of those volumes and determine which security style suits your needs. If you need a Windows Server Active Directory connection for SMB, NFSv4.1 Kerberos, or LDAP lookups, you should align that security baseline to compliance requirements, industry standards, and platform recommendations. Azure NetApp Files uses standard CryptoMod to generate AES-256 encryption keys, which you can apply to your SMB server. To develop an appropriate security strategy, enable LDAP over TLS, encrypt SMB connections to the domain controller, assign administrator privileged users for SMB volumes, and ensure that you have a backup policy and security. 
> - **Implement strict, conditional, and auditable identity and access management.** Set user privileges and restricted roles to help mitigate mistakes and improper actions. To maintain security, set appropriate share access permissions, ownership roles, and ownership mode for shares, files, and folders. To achieve optimal security and mitigate mistakes, identify and understand the various access management solutions for NFS, SMB, and dual-protocol shares. 

## Recommendations

| Recommendation | Benefit |
| - | - |
| Implement access management. Use a custom RBAC role for Azure NetApp Files to limit access for operations. For more information, see [Azure custom roles](/azure/role-based-access-control/custom-roles). <br><br> For a list of Azure NetApp Files resource provider operations, see [Microsoft.NetApp storage permissions](/azure/role-based-access-control/permissions/storage#microsoftnetapp). <br><br> [Restrict default access to Azure NetApp Files volumes.](/azure/azure-netapp-files/configure-network-features)<br><br> [Lock an Azure subscription, resource group, or resource](/azure/azure-resource-manager/management/lock-resources) to protect them from accidental user deletions and modifications.| Lock resources so that users don't accidentally create or delete new volumes. And you can prevent users from creating snapshots or backups. Lock resources to protect them from accidental user deletions and modifications.| 
| Set appropriate protocol-specific access controls. <br></br> Enable [access control lists (ACLs)](/azure/azure-netapp-files/nfs-access-control-lists) on NFSv4.1 volumes if you create an NFSv4.1 or dual-protocol volume. <br></br> Restrict mount path change permissions. For more information, see [Configure Unix permissions and change ownership mode for NFS and dual-protocol volumes](/azure/azure-netapp-files/configure-unix-permissions-change-ownership-mode). <br></br> For SMB or dual-protocol volumes, use ACLs that have SMB to control mounting and access via SMB to the shares. For more information, see [Modify share-level ACLs with Microsoft Management Console](/azure/azure-netapp-files/manage-smb-share-access-control-lists#modify-share-levels-acls-with-the-microsoft-management-console) and [Manage SMB share ACLs](/azure/azure-netapp-files/manage-smb-share-access-control-lists). <br></br> Use the new technology file system (NTFS) security style with [SMB shares](/azure/azure-netapp-files/network-attached-file-permissions-smb). For more information, see [Access control overview](/windows/security/identity-protection/access-control/access-control) | ACLs provide granular file security in NFSv4.1 and SMB. With NTFS, you can use NTFS ACLs. Use ACLs to restrict access to necessary users. |
| Set appropriate share access permissions, ownership, and ownership mode for NFS shares. NFS controls volume access permissions via IP addresses by using an export policy. For more information, see the following resources: <br><br> - [Understand NAS share permissions](/azure/azure-netapp-files/network-attached-storage-permissions). <br> - [Configure an export policy for NFS or dual-protocol volumes](/azure/azure-netapp-files/azure-netapp-files-configure-export-policy) <br> - [Configure Unix permissions and change ownership mode](/azure/azure-netapp-files/configure-unix-permissions-change-ownership-mode). <br></br>The owner and ownership mode dictates who owns and who can change the ownership of the volume. <br><br> Set appropriate file access permissions for files and folders within NFS shares. For more information about file access and permissions, see [Understand NAS file permissions](/azure/azure-netapp-files/network-attached-file-permissions) and [Understand mode bits](/azure/azure-netapp-files/network-attached-file-permissions). | Share-access permissions limit who can mount an NFS volume, the volume permissions, and who can change the volume owner. The file permissions control access to specific files and folders in a file system and are more granular than share permissions. | 
| Use a built-in or custom storage policy to restrict unsecure volumes or snapshots. For more information, see [Azure Policy definitions for Azure NetApp Files](/azure/azure-netapp-files/azure-policy-definitions). | Restrict unsecure volumes or creating snapshots with a policy to maintain the reliability and integrity of your applications. |
| Configure standard network features and an [NSG](/azure/virtual-network/network-security-groups-overview) on the Azure NetApp Files delegated subnet to filter network traffic to or from the Azure NetApp Files endpoint. <br><br> Consider limiting the routes and deploying user-defined routes on the Azure NetApp Files delegated subnet/network to only necessary traffic. | The NSG prevents unwanted or potentially malicious traffic from accessing Azure NetApp Files. User-defined routes help direct traffic to only where it's needed and to drop traffic to where it's not. This prevents unwanted or potentially malicious traffic getting to/from Azure NetApp Files. |
| Adopt an effective strategy for your account keys. To mitigate risk, [rotate the account keys periodically](/azure/azure-netapp-files/configure-customer-managed-keys#rekey-all-volumes-under-a-netapp-account). To manage the keys for volumes yourself, use [customer-managed keys](/azure/azure-netapp-files/configure-customer-managed-keys). | Rotate account keys to help prevent access by malicious actors. Customer-managed keys are helpful if you have a security requirement or regulation for self-managed keys. |
| Adopt an effective strategy for your account keys. Mitigate risk by [rotating the account keys periodically](/azure/azure-netapp-files/configure-customer-managed-keys#rekey-all-volumes-under-a-netapp-account) or consider using [customer-managed keys](/azure/azure-netapp-files/configure-customer-managed-keys) if you wish to manage the keys for volumes yourself. | Rotating account keys can help prevent access by malicious actors. Customer-managed keys are helpful if you have a security requirement or regulation for self-managed keys. |
| Reduce the visibility of resources. <br><br> If you configure a snapshot policy or take snapshots, [hide snapshot path for NFSv3 or SMB volumes](/azure/azure-netapp-files/snapshots-edit-hide-path). By default, the snapshot directory path is hidden from NFSv4.1 clients.<br><br> For NFSv4.1 and dual-protocol volumes, [disable the showmount](/azure/azure-netapp-files/disable-showmount).<br><br> For SMB, enable [access-based enumeration](/azure/azure-netapp-files/network-attached-storage-permissions) and [non-browsable SMB shares](/azure/azure-netapp-files/network-attached-storage-permissions#smb-shares) | Limiting the visibility of resources limits access. Hiding the snapshot path hides the directory path from NFSv3 or SMB clients adding an extra layer of protection. The directory remains accessible. Showmount on NFS clients is how users can see exported file systems on an NFS server, but can flag security probes as being a vulnerability. (However, some applications require showmount to be enabled.) <br><br> In SMB deployments, access-based enumeration creates a perimeter on your data, preventing unnecessary access to the share. Non-browsable SMB shares prevent the Windows client from browsing the SMB share. The share doesn't show up in the Windows File Browser or in the list of shares when you run the `net view \\server /all` command. |
| If you have dual-protocol volumes, [decide which security style](/azure/azure-netapp-files/dual-protocol-permission-behaviors) to implement. SMB and NFS use different permission models for user and group access. With dual-protocol volumes, Azure NetApp Files must be configured to use either the UNIX or the NTFS security style; only one security style can be active. | Understanding the needs of your dual-protocol workloads can help you optimize security. |
| Use double encryption for sensitive data at rest. By default, Azure NetApp Files encrypts data at rest. You set up [double encryption](/azure/azure-netapp-files/double-encryption-at-rest) by setting the encryption type to double when creating a capacity pool. | Double encryption encrypts both at the hardware level (encrypted SSD drives) and at the software layer at the volume level. |
| If you establish a connection to an Active Directory server, enable AES Encryption. This option enables AES encryption authentication support for the admin account of the AD connection. For more information, see [Create and manage Active Directory connections for Azure NetApp Files](/azure/azure-netapp-files/create-active-directory-connections). | AES encryption is a native and industry-standard platform encryption method to protect your data. |
| If you establish a connection to an Active Directory server and are using LDAP, consider enabling LDAP over TLS. For more information including restrictions on when LDAP can be used, see [LDAP encryption](/azure/azure-netapp-files/understand-data-encryption#ldap-encryption), [Create and manage Active Directory connections for Azure NetApp Files](/azure/azure-netapp-files/create-active-directory-connections), and [Configure AD DS LDAP over TLS for Azure NetApp Files](/azure/azure-netapp-files/configure-ldap-over-tls). | LDAP over TLS secures communication between an Azure NetApp Files volume and the Active Directory LDAP server. |
| Encrypt SMB connections to the Domain Controller. For information on enabling and configuring, see [Create and manage Active Directory connections for Azure NetApp Files](/azure/azure-netapp-files/create-active-directory-connections). | When enabled, only SMB3 is used for encrypted domain controller connections.|
| Determine and configure backup policy users, security privilege users, and administrators. If you establish a connection to an Active Directory Server, add the backup policy users, security privilege users, and administrators. For more information, see [Create and manage Active Directory connections for Azure NetApp Files](/azure/azure-netapp-files/create-active-directory-connections). | This option grants additional security privileges to AD DS domain users or groups as specified. |
| [Enable Kerberos for NFSv4.1](/azure/azure-netapp-files/configure-kerberos-encryption) for NFSv4.1 and dual-protocol volumes. | Depending on the encryption level you choose, Kerberos offers initial authentication, integrity checking, and privacy via a Kerberos ticket exchange. For more information, see [Understand data in-transit encryption](/azure/azure-netapp-files/understand-data-encryption#understand-data-in-transit-encryption). |
| Enable SMB3 protocol encryption for in-flight SMB3 data. For more information, see [SMB Shares](/azure/azure-netapp-files/network-attached-storage-permissions#smb-shares), [Understand data in-transit encryption](/azure/azure-netapp-files/understand-data-encryption#understand-data-in-transit-encryption), and [SMB Encryption](/azure/azure-netapp-files/azure-netapp-files-smb-performance#smb-encryption). | SMB clients not using SMB3 encryption aren't able to access this volume. Data at rest is encrypted regardless of this setting. |

## Cost optimization

Cost Optimization focuses on **detecting spend patterns, prioritizing investments in critical areas, and optimizing in others** to meet the organization's budget while meeting business requirements. 

The [Cost Optimization design principles](../cost-optimization/principles.md) provide a high-level design strategy for achieving those goals and making tradeoffs as necessary in the technical design related to Azure NetApp Files and its environment.

### Design checklist

Start your design strategy based on the [design review checklist for Cost Optimization](../cost-optimization/checklist.md) for investments. Fine-tune the design so that the workload is aligned with the budget that's allocated for the workload. Your design should use the right Azure capabilities, monitor investments, and find opportunities to optimize over time.

> [!div class="checklist"]
> - **Optimize component costs.** You should determine the specifics of your storage account and design your Azure NetApp Files capacity pools accordingly to optimize costs and lower TCO. Appropriately sizing your capacity pools to your needs and consolidating volumes in larger capacity pools with the appropriate QoS and performance tier enables performance while stymying unnecessary costs. Azure NetApp Files also allows you to tier infrequently accessed data to lower cost Azure storage with the cool access feature.
>
> - **Optimize environment costs.** Data protection and disaster recovery are essential to production workloads. Azure NetApp Files offers several built-in options, including snapshots that provide space-optimized restore points, backups that efficiently protect data on lower cost Azure storage tiers, and cross-region/cross-zone replication. Understanding each option as it fits your workload helps to optimize the cost of your deployment while ensuring disaster preparedness. 
> - **Understand and calculate pricing.** Understanding your business needs is essential to understanding pricing. Azure NetApp Files offers several tools, including the [Azure NetApp Files performance calculator](https://aka.ms/anfcalc), to help you accurately estimate pricing.
> - **Optimize scalability costs.** Azure NetApp Files is designed to meet your shifting business needs and to respond to changes in workloads, whether that be moving volumes to improve performance or to lower costs. With dynamic volume sizing, you can efficiently scale your Azure NetApp Files volumes to meet performance and capacity requirements on demand as needed.
> - **Optimize costs with partner solutions.** Azure NetApp Files integrates easily with products Azure VMware Solution (AVS) and SQL Server and is optimized for Oracle and SAP workloads. Understanding Azure NetApp Files' features and benefits can help you optimize your deployments, reducing total cost of ownership. For example, using Azure NetApp Files datastores enables you to increase storage capacity with AVS without utilizing additional AVS nodes. You can also calculate estimated costs for Azure VMware Solution and Azure NetApp Files with the [TCO estimator](https://bluexp.netapp.com/anf-avs/tcoestimator).

### Recommendations

Consider the following recommendations to optimize cost when you configure your NetApp account: 

| Recommendation | Benefit|
| - | - |
| Make use of the right performance tier, volume sizes and/or [QoS settings](/azure/azure-netapp-files/azure-netapp-files-service-levels) to ensure performance while preventing unnecessary costs. For volumes with manual QoS, the throughput limit can be defined individually. Performance planning in Azure NetApp Files requires a sound understanding of performance tiers and QoS. | The combination of the quota assigned to the volume and the selected service level determines the throughput limit for a volume with automatic QoS. Ensuring you have the appropriate performance tier and QoS settings can help you ensure the performance you need. |
| Use cool access to transparently tier infrequently accessed data to lower cost Azure storage. Using [Azure NetApp Files storage with cool access](/azure/azure-netapp-files/cool-access-introduction), you can configure inactive data to move from Azure NetApp Files storage to an Azure storage. | Cool access can reduce TCO by using a lower-cost storage tier. The move to the cool tier happens transparently for end users and applications. |
| [Appropriately size capacity pools](/azure/azure-netapp-files/faq-capacity-management) without unnecessary overhead/free space. There's no reason to maintain free space in a capacity pool. Only increase capacity pool sizes when there's a need to increase a volume's size or create a new volume. Be sure to reduce capacity pool sizes when volumes are deleted, or if volume sizes are reduced. | Appropriately sizing capacity pools ensures you only pay for the storage you need. |
| Share resources by consolidating as many volumes as possible within fewer, larger capacity pools, and leverage manual QoS to right size performance and capacity. Azure NetApp Files allows multiple volumes from disparate workloads to share a single capacity pool. Capacity pools set to manual QoS allow each volume to be configured with a custom size and throughput. For examples, see [Throughput limit examples of volumes in a manual QoS capacity pool](/azure/azure-netapp-files/azure-netapp-files-service-levels#throughput-limit-examples-of-volumes-in-a-manual-qos-capacity-pool). | Combining as many volumes as possible within the same capacity pool allows for increased capacity pool resource sharing while optimizing costs. |
| Use [native snapshots](/azure/azure-netapp-files/snapshots-introduction) to provide space-optimized restore points. | Azure NetApp Files snapshots can be used to provide restore points that are space-efficient and cost-efficient. |
| Use Azure NetApp Files backup to efficiently protect data on lower cost Azure storage. Azure NetApp Files supports [a fully managed backup solution](/azure/azure-netapp-files/backup-introduction) for long-term recovery, archive, and compliance. | Backups are incremental forever and fully managed to reduce the total cost of ownership. |
| Leverage [cross-region](/azure/azure-netapp-files/cross-region-replication-introduction) or [cross-zone](/azure/azure-netapp-files/cross-zone-replication-introduction) replication as a cost-optimized disaster recovery solution. | Azure NetApp Files provides a fully managed and cost-optimized disaster recovery solution using efficient replication technology. Data can be replicated between zones or regions, without the need for standing up infrastructure. |
| Implement dynamic volume shaping to provide on demand performance and capacity only when needed. For cost models comparing static against dynamic volume shaping, see [Cost model for Azure NetApp Files](/azure/azure-netapp-files/azure-netapp-files-cost-model#calculation-of-capacity-consumption). To better understand if Azure NetApp Files datastores can reduce your TCO when used with AVS, see the [Azure NetApp Files for Azure VMware Solution TCO estimator](https://aka.ms/anfavscalc). | With this option, you can have nondisruptive volume resizing and service level changes to meet changing performance requirements in real time to ensure you're only paying for performance and capacity when needed.|
| When deploying Azure VMware Solution (AVS), [use Azure NetApp Files datastores](/azure/azure-vmware/attach-azure-netapp-files-to-azure-vmware-solution-hosts). | AVS supports attaching Azure NetApp Files volumes to expand datastore capacity beyond what vSAN provides. You can increase storage capacity without additional AVS nodes. |
| When deploying SQL Server, using Azure NetApp Files enables you to deploy smaller VMs and take advantage of higher network throughput limits. Azure NetApp Files volumes can be used as an SMB share to host SQL Server databases. For more information, see [Benefits of using Azure NetApp Files for SQL Server deployment](/azure/azure-netapp-files/solutions-benefits-azure-netapp-files-sql-server).| Azure VMs typically have a higher network throughput versus disk throughput. Using Azure NetApp Files can allow the use of smaller Azure VM sizes resulting in a lower overall total cost of ownership. |
| When deploying SAP workloads, use Azure NetApp Files to lower the overall solution TCO by deploying smaller VMs and taking advantage of higher network throughput limits. For more information, see [SAP on Azure NetApp Files Sizing Best Practices](https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/sap-on-azure-netapp-files-sizing-best-practices/ba-p/3895300). | Azure NetApp Files volumes can be used with a variety of SAP workloads. Azure VMs typically have a higher network throughput vs. disk throughput. Using Azure NetApp Files can allow the use of smaller Azure VM sizes resulting in a lower overall total cost of ownership.|
| When deploying Oracle database workloads, use Azure NetApp Files to lower the overall solution TCO by deploying smaller VMs and taking advantage of higher network throughput limits. For more information, see [Run Your Most Demanding Oracle Workloads in Azure without Sacrificing Performance or Scalability](https://techcommunity.microsoft.com/t5/azure-architecture-blog/run-your-most-demanding-oracle-workloads-in-azure-without/ba-p/3264545). | Azure NetApp Files volumes can be used with a variety of Oracle database workloads. Azure VMs typically have a higher network throughput vs. disk throughput. Using Azure NetApp Files can allow the use of smaller Azure VM sizes resulting in a lower overall total cost of ownership.  |
| When deploying Siemens Teamcenter PLM, [use Azure NetApp Files](/azure/architecture/example-scenario/manufacturing/teamcenter-plm-netapp-files#cost-optimization) to lower the overall solution TCO in a variety of ways. | Azure NetApp Files can be deployed as a storage solution for Siemens Teamcenter PLM. Many cost optimization features can be used to lower the overall total cost of ownership. |

## Operational excellence

Operational Excellence primarily focuses on procedures for **development practices, observability, and release management**.

The [Operational Excellence design principles](../operational-excellence/principles.md) provide a high-level design strategy for achieving those goals for the operational requirements of the workload.

### Design checklist 

Start your design strategy based on the [design review checklist for Operational Excellence](../operational-excellence/checklist.md) for defining processes for observability, testing, and deployment related to your file storage configuration.

> [!div class="checklist"]
> - **Developing the proper architecture and design for your workloads can optimize performance and security.** Bringing a thorough understanding of LDAP, application filtering, and the Active Directory connector is essential to your Azure NetApp Files deployment, while understanding other features such as snapshots can ensure your data protection. 
>
> - **Deploy with confidence.** Understanding and managing limits can help you optimize your architecture for Azure NetApp Files. Solutions such as Azure Resource Manager (ARM) templates can help you automate your deployment, while test environments cloned from existing workloads enable dry runs using real data and scenarios. Using the built-in tools available in Azure NetApp Files can increase your confidence in your deployment. 
> - **Monitoring your routine operations can help you optimize performance and better understand different workloads.** Azure NetApp Files offers meaningful performance and capacity management tools, Azure-native monitoring features, and tools to manage your regional quotas and resource limits.
 Regular testing of your production environment enables you to adjust performance targets and optimize performance. With snapshot-based cloning and other features, Azure NetApp Files enables you to simulate your production workloads and environments to optimize your performance.

### Recommendations

Consider the following recommendations to optimize operational excellence when you configure your NetApp account:

| Recommendation | Benefit|
| - | - |
| Thoroughly understand the [AD connector, its options, and what the options do](/azure/azure-netapp-files/understand-guidelines-active-directory-domain-service-site). Proper AD DS design and planning are key to solution architectures that use Azure NetApp Files volumes. | Azure NetApp Files features such as SMB volumes, dual-protocol volumes, and NFSv4.1 Kerberos volumes are designed to be used with AD DS. Understanding AD DS deployment can help you optimize your Azure NetApp Files experience. |
| Thoroughly understand the use of [LDAP](/azure/azure-netapp-files/lightweight-directory-access-protocol). LDAP is a standard directory access protocol that was developed by an international committee called the Internet Engineering Task Force (IETF). LDAP is intended to provide a general-purpose, network-based directory service that you can use across heterogeneous platforms to locate network objects. | LDAP is robust, scalable, and secure. It offers the ability to contain millions of user and group objects. With Microsoft Active Directory, multiple servers can be used to replicate across multiple sites for both performance and resiliency scale. In Azure NetApp Files, Active Directory is the only currently supported LDAP server that can be used. This support includes both AD DS and Microsoft Entra Domain Services. |
| Use [native monitoring features](/azure/azure-netapp-files/monitor-azure-netapp-files) to monitor the performance and health of application volumes, file shares, and databases. | Use monitoring features to set up alerts and notifications for critical events such as file system capacity and performance problems. Alerts enable you to take corrective actions proactively. |
| [Manage performance:](/azure/azure-netapp-files/azure-netapp-files-performance-considerations) Azure NetApp Files offers nondisruptive on-demand [capacity scaling](/azure/azure-netapp-files/azure-netapp-files-resize-capacity-pools-or-volumes) and [service-level changes](/azure/azure-netapp-files/dynamic-change-volume-service-level). | These features enable you to scale up or down quickly as required by applications, file shares, and databases. These capabilities combined with volume resizing or manual quality of service (QoS) settings can help you manage the performance and availability of your application. |
| Use advanced [snapshot](/azure/azure-netapp-files/snapshots-introduction) data protection and data management capabilities. It provides the foundation for data protection solutions, including single-file restores, volume restores and clones, cross-region replication, and long-term retention. | Azure NetApp Files snapshot technology delivers stability, scalability, and faster recoverability without impact on performance.|
| Automate infrastructure deployments. Use [Azure Resource Manager templates](/azure/azure-netapp-files/azure-netapp-files-sdk-cli#azure-resource-manager-templates) to define and deploy the required resources that support your application, such as file shares, storage accounts, VMs, and databases. You can also consider using [Terraform](/azure/developer/terraform/overview) (IaC) for configuring and deploying cloud infrastructure. [Learn how to deploy Azure NetApp Files using Terraform](https://www.youtube.com/watch?v=TTV6rz52dPI) and refer to [Terraform AzureRM documentation on NetApp account integration](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/netapp_account). | Azure NetApp Files enables you to automate the deployment of your application infrastructure, file shares, and databases, increasing the efficiency of deployment while supporting a lift-and-shift. |
| Test deployments. Use [cloning via snapshot restore](/azure/azure-netapp-files/snapshots-introduction#restoring-cloning-an-online-snapshot-to-a-new-volume) to quickly create a new volume for testing. | Azure NetApp Files provides a reliable and scalable platform for deploying your application code, files, and databases. Cloning helps to ensure that your application is always up-to-date and stable, and you can test new releases or upgrades easily. |
| Test environments. You can use Azure NetApp Files to create and manage test environments quickly by [cloning your production data via snapshot restore to a new volume](/azure/azure-netapp-files/snapshots-introduction#restoring-cloning-an-online-snapshot-to-a-new-volume). | Testing activities remain separate from production environments. Testing creates guardrails such as ensuring the effectiveness of your DR solution. You can use the same process to test new releases or upgrades in a nondisruptive manner. Combining test environments with cross-zone or cross-region replication allows for further optimization by repurposing data normally replicated for disaster recovery purposes only. |
| Manage your regional quotas and [resource limits](/azure/azure-netapp-files/azure-netapp-files-resource-limits). Review those levels regularly as your workload evolves. If you need to increase regional quota [Request regional capacity quota increase](/azure/azure-netapp-files/regional-capacity-quota#request-regional-capacity-quota-increase) timely. If you need to increase resource limits, you can [request a limit increase](/azure/azure-netapp-files/azure-netapp-files-resource-limits#request-limit-increase) where applicable. | Quotas have an impact on cost and performance. Plan the amount of resources your workload requires. Review that level regularly as the workload evolves. Understanding these requirements ensures you maintain performance and capacity as needs change. |

## Performance efficiency

Performance Efficiency is about **maintaining user experience even when there's an increase in load** by managing capacity. The strategy includes scaling resources, identifying and optimizing potential bottlenecks, and optimizing for peak performance.

The [Performance Efficiency design principles](../performance-efficiency/principles.md) provide a high-level design strategy for achieving those capacity goals against the expected usage.

### Design checklist

Start your design strategy based on the [design review checklist for Performance Efficiency](../performance-efficiency/checklist.md). Define a baseline that's based on key performance indicators for Azure NetApp Files.

> [!div class="checklist"]
> - **Define performance targets.** You should understand the demands of your workload and assign numerical values to your performance targets. Azure NetApp Files offers tools and resources to quantify these demands, including calculators and formulas to convert throughput to IOPS. With this information, you should understand Azure NetApp Files service levels to understand the performance tiers of Azure NetApp Files to play your deployment to meet the needs of your workload. 
>
> - **Conduct capacity planning.** Understanding the capacity requirements of your datasets is essential for planning and optimizing performance. Before deploying your application, you should understand the nature of your workload and understand [resource limits of Azure NetApp Files](/azure/azure-netapp-files/azure-netapp-files-resource-limits). Situating your specific needs within the capabilities of Azure NetApp Files enables you to effectively plan for your performance requirements, making the configuration choices that deliver your performance and capacity needs.
> - **Select the right service.** As you define the needs of your Azure NetApp File deployment, you should understand the different performance, capacity, and data protection/disaster recovery requirements. These different options enable you to calibrate Azure NetApp Files to meet your specific throughput and general performance needs and, in some cases, reduce storage costs.
> - **Continually optimize performance.** Monitoring your volume performance helps you understand the shifting demands of your production workloads. Use these monitoring insights to optimize and tune your performance.

### Recommendations

| Recommendation | Benefit|
| - | - |
| Review and understand the Azure NetApp Files [service levels](/azure/azure-netapp-files/azure-netapp-files-service-levels), which provide performance ceilings for Azure NetApp Files volumes. | When performance needs for a workload change, you can dynamically, nondisruptively change the service levels of the volume for greater cost savings. |
| Understand [resource limits](/azure/azure-netapp-files/azure-netapp-files-resource-limits) of Azure NetApp Files. | Understanding the resource limits of Azure NetApp Files helps you reduce risk of overprovisioning or overtaxing your volume. |
| [Understand the nature of your workload](/azure/azure-netapp-files/faq-performance#how-do-i-convert-throughput-based-service-levels-of-azure-netapp-files-to-iops). Converting throughput to IOPS provides essential insights into performance. To understand how to establish performance baselines, see [Performance benchmark test recommendations for Azure NetApp Files](/azure/azure-netapp-files/azure-netapp-files-performance-metrics-volumes). <br> Use the [Azure NetApp Files performance calculator](https://aka.ms/anfcalc) to understand how your needs sit with Azure NetApp Files. | Understanding the IOPS/throughput/latency requirements of your workload is key to success. <br></br> Knowing the IOPS required along with the throughput helps you understand what service level and volume capacity is required. <br></br> The Azure NetApp Files performance calculator can help size your volume to maximize your performance and cost efficiency by selecting the correct capacity and service level. |
| Understand the [capacity requirements](/azure/azure-netapp-files/volume-quota-introduction) of the dataset and determine the appropriate [quality of service](/azure/azure-netapp-files/azure-netapp-files-understand-storage-hierarchy#qos_types). | Volume quotas and quality of service settings affect performance and are tied to volume capacity. If the dataset is small but performance requirements are high, manual quality of service can be used to overprovision the volume's performance. |
| Understand the difference between [regular volumes](/azure/azure-netapp-files/azure-netapp-files-understand-storage-hierarchy) and [large volumes](/azure/azure-netapp-files/large-volumes-requirements-considerations). | Large volumes can provide more capacity and performance but come with minimum requirements that might not fit with your workload. In the right context, large volumes can streamline your operation. |
| [Configure the capacity pool](/azure/azure-netapp-files/azure-netapp-files-set-up-capacity-pool) for capacity, throughput, and quality of service (QoS) policy desired. | Azure NetApp Files volumes use automatic QoS policies by default and are tied to the volume capacity. Manual QoS can be used to configure the capacity pool to provide higher performance for volumes. Manual QoS uses the capacity pool size for its performance levels. Understanding how capacity pools work enables you to tune Azure NetApp Files to deliver the optimal performance for your business needs. |
| [Optimize and tune Azure NetApp Files performance.](/azure/azure-netapp-files/faq-performance#what-should-i-do-to-optimize-or-tune-azure-netapp-files-performance) | The performance FAQ for Azure NetApp Files offers guidance on optimizing performance through network and VM configurations. |
| Consider [data protection and disaster recovery options](/azure/azure-netapp-files/data-protection-disaster-recovery-options). | Data protection and disaster recovery can play a part in consistent performance by providing a secondary site that can properly accommodate your workload's performance needs if outages occur. |
| [Monitor your Azure NetApp Files volume performance](/azure/azure-netapp-files/azure-netapp-files-metrics). | Monitoring the performance of your Azure NetApp Files volumes gives insights into workload's performance and whether you need to adjust service levels or QoS policies for greater or lower performance. |

## Azure policies

Azure provides an extensive set of built-in policies related to Azure NetApp Files. Some of the preceding recommendations can be audited through Azure policies. Consider the following policies that are related to security:

- [Azure NetApp Files SMB volumes should use SMB3 encryption](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fddcf4b94-9dfa-4a80-aca6-22bb654fde72)
- [Azure NetApp Files NFSv4.1 volumes should use Kerberos data encryption](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7c6c7139-7d8e-45d0-9d94-72386a61308b)
- [Azure NetApp Files NFSv4.1 volumes should use Kerberos data integrity or data privacy](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F16f4af95-96b1-4220-805a-367ca59cd72e)
- [Azure NetApp Files volumes shouldn't use NFSv3 protocol type](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd558e1a6-296d-4fbb-81a5-ea25822639f6)

## Azure Advisor recommendations

Advisor is a personalized cloud consultant that helps you follow best practices to optimize your Azure NetApp Files deployments. Here are some recommendations that can help you improve the reliability, security, cost effectiveness, performance, and operational excellence of Azure NetApp Files.

Consider the following [Advisor](https://azure.microsoft.com/products/advisor/) recommendation for cost effectiveness:

- Save on-demand costs with reserved capacity.

Consider the following [Advisor](https://azure.microsoft.com/products/advisor/) recommendations for reliability:

- Implement disaster recovery strategies for your Azure NetApp Files resources.
- Enable Continuous Availability for SMB volumes.
- Review SAP configuration for timeout values used with Azure NetApp Files.

## Next steps

- [Azure NetApp Files documentation](/azure/azure-netapp-files/)
- [Storage hierarchy of Azure NetApp Files](/azure/azure-netapp-files/azure-netapp-files-understand-storage-hierarchy)
- [Solution architectures using Azure NetApp Files](/azure/azure-netapp-files/azure-netapp-files-solution-architectures)